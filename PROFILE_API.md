# Profile API Documentation

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–æ–≤—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–æ—Ñ–∏–ª—è–º–∏, —Ä–µ–π—Ç–∏–Ω–≥–∞–º–∏ –∏ –≥—Ä—É–ø–ø–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

## –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ —Å—Ö–µ–º–µ User
–î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –ø–æ–ª—è:
- `city` (string) - –ì–æ—Ä–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `bio` (string) - –ë–∏–æ–≥—Ä–∞—Ñ–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `avatarLetter` (string) - –ë—É–∫–≤–∞ –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∞

### 2. –ù–æ–≤—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –ø—Ä–æ—Ñ–∏–ª–µ–π

#### GET `/api/users/profile`
–ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞.

**–û—Ç–≤–µ—Ç:**
```json
{
  "name": "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ê—Ä—Ö–∏–ø–æ–≤",
  "username": "kvansum_architect",
  "telegramId": "726381902",
  "totalPoints": 12840,
  "avatarLetter": "–ê",
  "rankKey": "architect",
  "city": "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",
  "bio": "–°–æ–∑–¥–∞—é –Ω–æ–≤—ã–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–≤—è–∑–∫–∏ –ø—Ä–∏–≤—ã—á–µ–∫ –∏ –≤–µ–¥—É KVANSUM-–∫–æ–º—å—é–Ω–∏—Ç–∏."
}
```

#### GET `/api/users/leaderboard`
–ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (—Ç–æ–ø-100 –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é).

**–û—Ç–≤–µ—Ç:**
```json
[
  {
    "id": "user-1",
    "name": "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä",
    "rank": "–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä",
    "rankIcon": "üèóÔ∏è",
    "points": 12840,
    "trophies": 321,
    "streakEmoji": "üî•",
    "energyEmoji": "üí™",
    "growthEmoji": "üèóÔ∏è",
    "isYou": true,
    "position": 1,
    "profilePath": "/profile/user-1"
  },
  ...
]
```

#### PATCH `/api/users/me`
–û–±–Ω–æ–≤–ª–µ–Ω—ã –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è. –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å:
- `firstName` - –ò–º—è
- `lastName` - –§–∞–º–∏–ª–∏—è
- `email` - Email
- `username` - –õ–æ–≥–∏–Ω
- `city` - –ì–æ—Ä–æ–¥ (–Ω–æ–≤–æ–µ)
- `bio` - –ë–∏–æ–≥—Ä–∞—Ñ–∏—è (–Ω–æ–≤–æ–µ)
- `avatarLetter` - –ë—É–∫–≤–∞ –∞–≤–∞—Ç–∞—Ä–∞ (–Ω–æ–≤–æ–µ)

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "city": "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",
  "bio": "–°–æ–∑–¥–∞—é –Ω–æ–≤—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏",
  "avatarLetter": "–ê"
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "id": "user-1",
  "username": "kvansum_architect",
  "firstName": "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä",
  "lastName": "–ê—Ä—Ö–∏–ø–æ–≤",
  "email": "user@example.com",
  "city": "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",
  "bio": "–°–æ–∑–¥–∞—é –Ω–æ–≤—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏",
  "avatarLetter": "–ê",
  "createdAt": "2025-01-01T00:00:00.000Z"
}
```

### 3. API –¥–ª—è –≥—Ä—É–ø–ø (Party)

–°–æ–∑–¥–∞–Ω –ø–æ–ª–Ω—ã–π –º–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≥—Ä—É–ø–ø–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

#### POST `/api/party`
–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –≥—Ä—É–ø–ø—ã.

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "name": "–ì—Ä—É–ø–ø–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–∞"
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "_id": "party-id",
  "name": "–ì—Ä—É–ø–ø–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–∞",
  "ownerId": "user-id",
  "members": [
    {
      "id": "user-id",
      "name": "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä"
    }
  ],
  "invites": [],
  "maxMembers": 10,
  "createdAt": "2025-01-01T00:00:00.000Z"
}
```

#### GET `/api/party/my`
–ü–æ–ª—É—á–µ–Ω–∏–µ –≥—Ä—É–ø–ø—ã —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–≥–¥–µ –æ–Ω –≤–ª–∞–¥–µ–ª–µ—Ü –∏–ª–∏ —É—á–∞—Å—Ç–Ω–∏–∫).

**–û—Ç–≤–µ—Ç:**
```json
{
  "id": "party-id",
  "name": "–ì—Ä—É–ø–ø–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–∞",
  "ownerId": "user-id",
  "members": [
    {
      "id": "user-id",
      "name": "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä"
    },
    {
      "id": "user-2",
      "name": "–°–µ—Ä–≥–µ–π"
    }
  ],
  "invites": [
    {
      "id": "user-3",
      "name": "–ê–Ω—è"
    }
  ]
}
```

–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Å–æ—Å—Ç–æ–∏—Ç –Ω–∏ –≤ –∫–∞–∫–æ–π –≥—Ä—É–ø–ø–µ, –≤–µ—Ä–Ω–µ—Ç—Å—è `null`.

#### GET `/api/party/available-users`
–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –≤ –≥—Ä—É–ø–ø—É.

**–û—Ç–≤–µ—Ç:**
```json
[
  {
    "id": "user-2",
    "name": "–°–µ—Ä–≥–µ–π"
  },
  {
    "id": "user-3",
    "name": "–ê–Ω—è"
  },
  ...
]
```

#### PATCH `/api/party/:id`
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –≥—Ä—É–ø–ø—ã (—Ç–æ–ª—å–∫–æ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞).

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "name": "–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã"
}
```

#### POST `/api/party/:id/invite`
–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É (—Ç–æ–ª—å–∫–æ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞).

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "userId": "user-id-to-invite"
}
```

**–û—Ç–≤–µ—Ç:** –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≥—Ä—É–ø–ø—ã —Å –Ω–æ–≤—ã–º –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ–º.

#### POST `/api/party/:id/accept`
–ü—Ä–∏–Ω—è—Ç–∏–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –≤ –≥—Ä—É–ø–ø—É.

**–û—Ç–≤–µ—Ç:** –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≥—Ä—É–ø–ø—ã —Å –Ω–æ–≤—ã–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–º.

#### POST `/api/party/:id/leave`
–ü–æ–∫–∏–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã (–Ω–µ –¥–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞).

**–û—Ç–≤–µ—Ç:**
```json
{
  "message": "–í—ã –ø–æ–∫–∏–Ω—É–ª–∏ –≥—Ä—É–ø–ø—É"
}
```

#### DELETE `/api/party/:id`
–£–¥–∞–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø—ã (—Ç–æ–ª—å–∫–æ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞).

**–û—Ç–≤–µ—Ç:**
```json
{
  "message": "–ì—Ä—É–ø–ø–∞ —É–¥–∞–ª–µ–Ω–∞"
}
```

## –ú–∞–ø–ø–∏–Ω–≥ —Ä–∞–Ω–≥–æ–≤

–†–∞–Ω–≥–∏ –≤ —Å–∏—Å—Ç–µ–º–µ:
- `beginner` (–ù–∞—á–∏–Ω–∞—é—â–∏–π) - üå±
- `observer` (–ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å) - üîé
- `active` (–ê–∫—Ç–∏–≤–Ω—ã–π) - ‚ö°
- `systemic` (–°–∏—Å—Ç–µ–º–Ω—ã–π) - üîÑ
- `architect` (–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä) - üèóÔ∏è
- `scaling` (–ú–∞—Å—à—Ç–∞–±–∏—Ä—É—é—â–∏–π) - üöÄ

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### avatarLetter
–ï—Å–ª–∏ `avatarLetter` –Ω–µ —É–∫–∞–∑–∞–Ω –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è, –æ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∏–∑:
1. –ü–µ—Ä–≤–æ–π –±—É–∫–≤—ã `firstName`
2. –ò–ª–∏ –ø–µ—Ä–≤–æ–π –±—É–∫–≤—ã `username`
3. –ò–ª–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ "–£"

### –¢—Ä–æ—Ñ–µ–∏
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–æ—Ñ–µ–µ–≤ –≤ —Ä–µ–π—Ç–∏–Ω–≥–µ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ:
```
trophies = max(3, round(totalPoints / 40))
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### User Schema
```typescript
{
  telegramId?: number;
  username?: string;
  firstName?: string;
  lastName?: string;
  email?: string;
  city?: string;          // –Ω–æ–≤–æ–µ
  bio?: string;           // –Ω–æ–≤–æ–µ
  avatarLetter?: string;  // –Ω–æ–≤–æ–µ
}
```

### Party Schema
```typescript
{
  name: string;
  ownerId: ObjectId;
  members: [
    {
      id: ObjectId;
      name: string;
    }
  ];
  invites: [
    {
      id: ObjectId;
      name: string;
      invitedAt: Date;
    }
  ];
  maxMembers: number; // default: 10
}
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
```bash
curl -X GET http://localhost:3000/api/users/profile \
  -H "Authorization: Bearer YOUR_TOKEN"
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞
```bash
curl -X GET http://localhost:3000/api/users/leaderboard \
  -H "Authorization: Bearer YOUR_TOKEN"
```

### –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã
```bash
curl -X POST http://localhost:3000/api/party \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"name": "–ú–æ—è –≥—Ä—É–ø–ø–∞"}'
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–≤–æ–µ–π –≥—Ä—É–ø–ø—ã
```bash
curl -X GET http://localhost:3000/api/party/my \
  -H "Authorization: Bearer YOUR_TOKEN"
```

### –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É
```bash
curl -X POST http://localhost:3000/api/party/PARTY_ID/invite \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"userId": "USER_ID_TO_INVITE"}'
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:
```
http://localhost:3000/api
```

–í—Å–µ –Ω–æ–≤—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –≤ —Ä–∞–∑–¥–µ–ª–∞—Ö:
- **users** - —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –ø—Ä–æ—Ñ–∏–ª—è –∏ —Ä–µ–π—Ç–∏–Ω–≥–∞
- **party** - —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≥—Ä—É–ø–ø–∞–º–∏

