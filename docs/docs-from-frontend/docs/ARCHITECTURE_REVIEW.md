# ๐ ะะตะฒะธะทะธั ะฐััะธัะตะบัััั: 3 ะธััะพัะฝะธะบะฐ ะดะฐะฝะฝัั

## โ ะงัะพ ะฑัะปะพ ะธัะฟัะฐะฒะปะตะฝะพ

### **ะัะพะฑะปะตะผะฐ (ะดะพ):**
- ะะพะผะฟะพะฝะตะฝั `DashboardClient.tsx` ะธะผะตะป **ัะฐัะดะบะพะด** ะดะฐะฝะฝัั ะฟััะผะพ ะฒะฝัััะธ
- ะะพะบะพะฒัะต ะดะฐะฝะฝัะต ะฒ ะฟะฐะฟะบะต `src/features/habits/data/` **ะะ ะธัะฟะพะปัะทะพะฒะฐะปะธัั**
- ะะตะฒะพะทะผะพะถะฝะพ ะฑัะปะพ ะฟะพะดะบะปััะธัั ัะตะฐะปัะฝัะน API ะฒ ะฑัะดััะตะผ

### **ะะตัะตะฝะธะต (ัะตะนัะฐั):**
ะขะตะฟะตัั ะฐััะธัะตะบัััะฐ ะฟัะฐะฒะธะปัะฝะพ ัะฐะทะดะตะปะตะฝะฐ ะฝะฐ **Server** ะธ **Client** ะบะพะผะฟะพะฝะตะฝัั:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  page.tsx (Server Component)                            โ
โ  โ ะะพะปััะฐะตั ะดะฐะฝะฝัะต ะธะท 3 ะธััะพัะฝะธะบะพะฒ                      โ
โ  โโ HABITS (ะฟัะธะฒััะบะธ)                                   โ
โ  โโ LEVELS (ััะพะฒะฝะธ)                                     โ
โ  โโ PROGRESS (ะฟัะพะณัะตัั ะฟะพะปัะทะพะฒะฐัะตะปั)                    โ
โโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                   โ ะะตัะตะดะฐะตั ัะตัะตะท props
                   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  DashboardClient.tsx (Client Component)                 โ
โ  โ ะัะธะฝะธะผะฐะตั ะดะฐะฝะฝัะต ะธ ัะตะฝะดะตัะธั UI                       โ
โ  โโ ะะพะฝะฒะตััะธััะตั ะดะฐะฝะฝัะต ะฒ ัะพัะผะฐั UI                     โ
โ  โโ ะคะธะปััััะตั ะฟัะธะฒััะบะธ ะฟะพ ััะพะฒะฝั                        โ
โ  โโ ะฃะฟัะฐะฒะปัะตั ัะพััะพัะฝะธะตะผ (statuses, activeIndex)        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ ะะตัะฐะปัะฝัะน ะฐะฝะฐะปะธะท

### **1. Server Component: `page.tsx`**

```typescript
// apps/web/app/(app)/dashboard/page.tsx

import { HABITS } from '@/features/habits/data/habits.mock';
import { LEVELS } from '@/features/habits/data/levels.mock';
import { PROGRESS } from '@/features/habits/data/progress.mock';

export default function Page() {
  // ๐ฏ ะะดะตัั 3 ะธััะพัะฝะธะบะฐ ะดะฐะฝะฝัั
  const habits = HABITS;    // 23 ะฟัะธะฒััะบะธ ะธะท ะผะพะบะพะฒ
  const levels = LEVELS;    // 7 ััะพะฒะฝะตะน
  const progress = PROGRESS; // ะัะพะณัะตัั ะฟะพะปัะทะพะฒะฐัะตะปั

  // ๐ก ะ ะฑัะดััะตะผ ะปะตะณะบะพ ะทะฐะผะตะฝะธัั ะฝะฐ:
  // const habits = await fetchHabits();
  // const levels = await fetchLevels();
  // const progress = await fetchProgress();

  return (
    <DashboardClient 
      habits={habits}
      levels={levels}
      progress={progress}
    />
  );
}
```

**ะงัะพ ะทะดะตัั ะฟัะพะธััะพะดะธั:**
- โ **Server-side ัะตะฝะดะตัะธะฝะณ** - ะดะฐะฝะฝัะต ะฟะพะปััะฐัััั ะฝะฐ ัะตัะฒะตัะต
- โ **3 ะธััะพัะฝะธะบะฐ ะดะฐะฝะฝัั** ัะตัะบะพ ัะฐะทะดะตะปะตะฝั
- โ **ะะตะณะบะพ ะผะธะณัะธัะพะฒะฐัั ะฝะฐ API** - ะฟัะพััะพ ัะฐัะบะพะผะผะตะฝัะธัะพะฒะฐัั await fetch

---

### **2. Client Component: `DashboardClient.tsx`**

```typescript
interface DashboardClientProps {
  habits: HabitFromTypes[];  // ะะท habits.mock.ts
  levels: Level[];           // ะะท levels.mock.ts
  progress: Progress;        // ะะท progress.mock.ts
}

export default function DashboardClient({ habits, levels, progress }: DashboardClientProps) {
  // ะะพะฝะฒะตััะธััะตะผ ะดะฐะฝะฝัะต ั ัะตัะฒะตัะฐ ะฒ ัะพัะผะฐั UI
  const habitCards: HabitCard[] = useMemo(() => {
    const currentLevelId = 'lvl1'; // ะะพะบะฐะทัะฒะฐะตะผ ัะพะปัะบะพ ััะพะฒะตะฝั 1
    return habits
      .filter(h => h.levelId === currentLevelId)
      .map(h => convertToHabitCard(h, progress));
  }, [habits, progress]);

  // ะััะฐะปัะฝะฐั ะปะพะณะธะบะฐ UI...
}
```

**ะงัะพ ะทะดะตัั ะฟัะพะธััะพะดะธั:**
- โ ะัะธะฝะธะผะฐะตั ะดะฐะฝะฝัะต ัะตัะตะท **props** (ะฝะต ัะฐัะดะบะพะด!)
- โ **ะะพะฝะฒะตััะธััะตั** ะดะฐะฝะฝัะต ะธะท ัะธะฟะพะฒ API ะฒ ัะธะฟั UI
- โ **ะคะธะปััััะตั** ะฟัะธะฒััะบะธ ะฟะพ ััะพะฒะฝั (ัะตะนัะฐั lvl1)
- โ ะัะฟะพะปัะทัะตั ัะตะฐะปัะฝัะต **streak** ะธะท `progress.habitStreak`

---

## ๐ ะััะพัะฝะธะบะธ ะดะฐะฝะฝัั

### **1. Habits (ะัะธะฒััะบะธ)**
**ะคะฐะนะป:** `apps/web/src/features/habits/data/habits.mock.ts`

```typescript
export const HABITS: Habit[] = [
  {
    id: 'h-water',
    levelId: 'lvl1',
    title: 'ะกัะฐะบะฐะฝ ะฒะพะดั ะฟะพัะปะต ะฟัะพะฑัะถะดะตะฝะธั',
    difficulty: 'easy',
    timeOfDay: 'morning',
    days: ['daily'],
    emoji: '๐ง',
    summary: 'ะะฐะฟััะบะฐะตั ะพะฑะผะตะฝ ะฒะตัะตััะฒ...',
    stages: [...],
  },
  // ... 22 ะดััะณะธั ะฟัะธะฒััะบะธ
];
```

**ะงัะพ ัะพะดะตัะถะธั:** 23 ะฟัะธะฒััะบะธ, ัะฐัะฟัะตะดะตะปะตะฝะฝัะต ะฟะพ 7 ััะพะฒะฝัะผ

---

### **2. Levels (ะฃัะพะฒะฝะธ)**
**ะคะฐะนะป:** `apps/web/src/features/habits/data/levels.mock.ts`

```typescript
export const LEVELS: Level[] = [
  {
    id: 'lvl1',
    order: 1,
    title: 'ะญะฝะตัะณะธั ะธ ะฑะฐะทะพะฒัะต ัะตััััั',
    description: 'ะัะธะฒััะบะธ, ะบะพัะพััะต ะทะฐััะถะฐัั ัะตะปะพ...',
    emoji: '๐ฉต',
    nextLevelId: 'lvl2',
  },
  // ... 6 ะดััะณะธั ััะพะฒะฝะตะน
];
```

**ะงัะพ ัะพะดะตัะถะธั:** 7 ััะพะฒะฝะตะน ั ะฟัะฐะฒะธะปะฐะผะธ ัะฐะทะฑะปะพะบะธัะพะฒะบะธ

---

### **3. Progress (ะัะพะณัะตัั)**
**ะคะฐะนะป:** `apps/web/src/features/habits/data/progress.mock.ts`

```typescript
export const PROGRESS: Progress = {
  completionByDate: {},
  habitStreak: {
    'h-water': 18,    // 18 ะดะฝะตะน ะฟะพะดััะด
    'h-bed': 12,
    'h-stretch': 9,
    // ...
  },
  levelUnlockedAt: {
    lvl1: '2025-09-01',
    lvl2: undefined,  // ะัะต ะฝะต ัะฐะทะฑะปะพะบะธัะพะฒะฐะฝ
    // ...
  },
};
```

**ะงัะพ ัะพะดะตัะถะธั:** ะขะตะบััะธะน ะฟัะพะณัะตัั ะฟะพะปัะทะพะฒะฐัะตะปั, ัััะธะบะธ, ัะฐะทะฑะปะพะบะธัะพะฒะฐะฝะฝัะต ััะพะฒะฝะธ

---

## ๐ฏ ะะฐะบ ััะพ ัะฐะฑะพัะฐะตั ะฒะผะตััะต

### **ะัะธะผะตั: ะัะพะฑัะฐะถะตะฝะธะต ะฟัะธะฒััะบะธ "ะกัะฐะบะฐะฝ ะฒะพะดั"**

1. **Server Component** (`page.tsx`):
   ```typescript
   const habits = HABITS;    // h-water, h-bed, h-stretch, h-cold
   const progress = PROGRESS; // habitStreak['h-water'] = 18
   ```

2. **Client Component** (`DashboardClient.tsx`):
   ```typescript
   // ะะพะฝะฒะตััะฐัะธั ะดะฐะฝะฝัั
   {
     id: 'h-water',
     name: 'ะกัะฐะบะฐะฝ ะฒะพะดั ะฟะพัะปะต ะฟัะพะฑัะถะดะตะฝะธั',
     emoji: '๐ง',
     time: '07:00',  // ะธะท timeOfDay: 'morning'
     note: 'ะะฐะฟััะบะฐะตั ะพะฑะผะตะฝ ะฒะตัะตััะฒ...',
     streak: 18,      // ะธะท progress.habitStreak['h-water']
   }
   ```

3. **UI ะพัะพะฑัะฐะถะฐะตั:**
   - ๐ง **ะกัะฐะบะฐะฝ ะฒะพะดั ะฟะพัะปะต ะฟัะพะฑัะถะดะตะฝะธั**
   - โฐ 07:00
   - ๐ฅ **18 ะดะฝะตะน ะฟะพะดััะด**
   - ๐ ะะฐะฟััะบะฐะตั ะพะฑะผะตะฝ ะฒะตัะตััะฒ...

---

## ๐ ะะธะณัะฐัะธั ะฝะฐ ัะตะฐะปัะฝัะน API

ะะพะณะดะฐ ะฑัะบะตะฝะด ะฑัะดะตั ะณะพัะพะฒ, ะฝัะถะฝะพ ัะพะปัะบะพ ะธะทะผะตะฝะธัั `page.tsx`:

```typescript
// apps/web/app/(app)/dashboard/page.tsx

export default async function Page() {
  // ะะฐะผะตะฝะธัั ะผะพะบะธ ะฝะฐ ัะตะฐะปัะฝัะต API-ะฒัะทะพะฒั
  const habits = await fetch('/api/habits').then(r => r.json());
  const levels = await fetch('/api/levels').then(r => r.json());
  const progress = await fetch('/api/progress').then(r => r.json());

  return (
    <DashboardClient 
      habits={habits}
      levels={levels}
      progress={progress}
    />
  );
}
```

**ะะปะธะตะฝััะบะธะน ะบะพะผะฟะพะฝะตะฝั ะะ ะฝัะถะฝะพ ะผะตะฝััั!** ๐

---

## โ Checklist ะฟัะฐะฒะธะปัะฝะพััะธ

- โ **3 ะธััะพัะฝะธะบะฐ ะดะฐะฝะฝัั** ัะตัะบะพ ัะฐะทะดะตะปะตะฝั
- โ **Server Component** ะฟะพะปััะฐะตั ะดะฐะฝะฝัะต (SSR)
- โ **Client Component** ัะพะปัะบะพ ัะตะฝะดะตัะธั UI
- โ **ะขะธะฟะธะทะฐัะธั** ัะตัะตะท TypeScript
- โ **ะะพะบะพะฒัะต ะดะฐะฝะฝัะต ะธัะฟะพะปัะทััััั** (ะฝะต ัะฐัะดะบะพะด ะฒ ะบะพะผะฟะพะฝะตะฝัะฐั)
- โ **ะะตะณะบะพ ะผะธะณัะธัะพะฒะฐัั ะฝะฐ API** (ะผะตะฝัะตััั ัะพะปัะบะพ page.tsx)
- โ **ะะฐะฝะฝัะต ะฟะตัะตะดะฐัััั ัะตัะตะท props** (React best practice)

---

## ๐ง ะะพะฟะพะปะฝะธัะตะปัะฝัะต ัะปัััะตะฝะธั (ะพะฟัะธะพะฝะฐะปัะฝะพ)

### 1. **ะะธะฝะฐะผะธัะตัะบะธะน ะฒัะฑะพั ััะพะฒะฝั**
ะกะตะนัะฐั ะฟะพะบะฐะทัะฒะฐัััั ัะพะปัะบะพ ะฟัะธะฒััะบะธ ััะพะฒะฝั 1. ะะพะถะฝะพ ะดะพะฑะฐะฒะธัั ะปะพะณะธะบั:

```typescript
const currentLevelId = useMemo(() => {
  // ะะฟัะตะดะตะปะธัั ัะตะบััะธะน ััะพะฒะตะฝั ะฝะฐ ะพัะฝะพะฒะต progress.levelUnlockedAt
  const unlockedLevels = Object.entries(progress.levelUnlockedAt)
    .filter(([_, date]) => date !== undefined)
    .map(([id]) => id);
  
  return unlockedLevels[unlockedLevels.length - 1] || 'lvl1';
}, [progress]);
```

### 2. **ะัะฟะพะปัะทะพะฒะฐัั ะดะฐะฝะฝัะต ะพ ัะตะบััะตะผ ะดะฝะต**
ะะพะฑะฐะฒะธัั ัะธะปัััะฐัะธั ะฟัะธะฒััะตะบ ะฟะพ ะดะฝัะผ ะฝะตะดะตะปะธ:

```typescript
const todayHabits = habits.filter(h => {
  const today = new Date().toLocaleDateString('en', { weekday: 'short' }).toLowerCase();
  return h.days.includes('daily') || h.days.includes(today);
});
```

### 3. **ะะฝัะตะณัะฐัะธั ั artifacts**
ะะพะบะฐะทัะฒะฐัั ัะฐะทะฑะปะพะบะธัะพะฒะฐะฝะฝัะต ะฐััะตัะฐะบัั ะฝะฐ ะพัะฝะพะฒะต ะฟัะพะณัะตััะฐ:

```typescript
import { ARTIFACTS } from '@/features/habits/data/artifacts.mock';

const unlockedArtifacts = ARTIFACTS.filter(artifact => {
  if (artifact.unlock.type === 'habit_stage') {
    const currentStreak = progress.habitStreak[artifact.unlock.habitId];
    return currentStreak >= artifact.unlock.days;
  }
  // ... ะปะพะณะธะบะฐ ะดะปั level_progress
});
```

---

## ๐ ะะตะทัะผะต

**โ ะััะธัะตะบัััะฐ ะบะพััะตะบัะฝะฐ!**

ะั ะฟัะฐะฒะธะปัะฝะพ ัะฐะทะดะตะปะธะปะธ:
1. **ะััะพัะฝะธะบะธ ะดะฐะฝะฝัั** (habits, levels, progress)
2. **Server Component** (ะฟะพะปััะตะฝะธะต ะดะฐะฝะฝัั)
3. **Client Component** (UI ะธ ะธะฝัะตัะฐะบัะธะฒะฝะพััั)

ะขะตะฟะตัั:
- โ ะะพะบะพะฒัะต ะดะฐะฝะฝัะต **ะธัะฟะพะปัะทััััั**
- โ ะะตะณะบะพ **ะผะธะณัะธัะพะฒะฐัั ะฝะฐ API**
- โ ะกะปะตะดัะตั **Next.js 13+ best practices**
- โ ะขะธะฟะธะทะธัะพะฒะฐะฝะพ ัะตัะตะท **TypeScript**

๐ **ะะพัะพะฒะพ ะบ ัะฐะทัะฐะฑะพัะบะต!**

